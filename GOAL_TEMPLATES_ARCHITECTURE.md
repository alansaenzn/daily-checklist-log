# Goal Templates - Architecture Diagram

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         User Browser                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              /templates Page (React)                       â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚  GoalTemplatesListView (Client Component)           â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ Focus Filter Pills (Productivity, Training...) â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ Grid of GoalTemplateCard Components     â”‚   â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ [Card] [Card] [Card]                     â”‚   â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚  Name                                    â”‚   â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚  Description                             â”‚   â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚  [Preview] [Apply]                      â”‚   â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚                                                  â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ GoalTemplatePreview Modal (on Preview)  â”‚   â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚  âœ• Close                                â”‚   â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚  Template Name [Badge: Focus Area]      â”‚   â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚  Description                             â”‚   â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚  â”‚ Task 1                              â”‚ â”‚   â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚  â”‚ Task 2 [Optional]                   â”‚ â”‚   â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚  â”‚ Task 3                              â”‚ â”‚   â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â”‚  [Cancel] [Apply Template]              â”‚   â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚                                                  â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ Toast Notifications (Success/Error)           â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                                                        â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  State Management:                                   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  - selectedFocus (filter)                            â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  - previewTemplate (modal state)                     â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  - isApplying (loading state)                        â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  - notification (toast)                              â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                                â”‚ â”‚
â”‚  â”‚  Triggered on:                                               â”‚ â”‚
â”‚  â”‚  - User clicks "Preview" â†’ getGoalTemplateWithTasks()        â”‚ â”‚
â”‚  â”‚  - User clicks "Apply" â†’ applyGoalTemplate()                â”‚ â”‚
â”‚  â”‚  - User filters â†’ recalculates filteredTemplates            â”‚ â”‚
â”‚  â”‚                                                                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                           â”‚      â”‚                                â”‚
â”‚                           â†“      â†“                                â”‚
â”‚              Server Actions (via POST)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                        â”‚
           â”‚                                        â”‚
           â†“                                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  getGoalTemplateWithTasks    â”‚    â”‚  applyGoalTemplate           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚  1. Auth check               â”‚    â”‚  1. Auth check              â”‚
â”‚  2. Fetch goal_templates     â”‚    â”‚  2. Fetch template + tasks  â”‚
â”‚  3. Fetch goal_template_tasks â”‚   â”‚  3. Create task_templates   â”‚
â”‚  4. Return combined          â”‚    â”‚  4. Return success message  â”‚
â”‚                              â”‚    â”‚                             â”‚
â”‚  Errors:                     â”‚    â”‚  Errors:                    â”‚
â”‚  - Not authenticated         â”‚    â”‚  - Not authenticated        â”‚
â”‚  - Template not found        â”‚    â”‚  - No tasks in template     â”‚
â”‚  - Unauthorized              â”‚    â”‚  - DB insert error          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                        â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Supabase (Database)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  goal_templates      â”‚          â”‚ goal_template_tasks      â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ id                   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ goal_template_id (FK)    â”‚â”‚
â”‚  â”‚ name                 â”‚          â”‚ id                       â”‚â”‚
â”‚  â”‚ description          â”‚          â”‚ title                    â”‚â”‚
â”‚  â”‚ focus_area           â”‚          â”‚ description              â”‚â”‚
â”‚  â”‚ is_system            â”‚          â”‚ category                 â”‚â”‚
â”‚  â”‚ created_by           â”‚          â”‚ is_optional              â”‚â”‚
â”‚  â”‚ created_at           â”‚          â”‚ estimated_duration       â”‚â”‚
â”‚  â”‚ updated_at           â”‚          â”‚ display_order            â”‚â”‚
â”‚  â”‚                      â”‚          â”‚ created_at               â”‚â”‚
â”‚  â”‚ Indexes:             â”‚          â”‚ updated_at               â”‚â”‚
â”‚  â”‚ - focus_area         â”‚          â”‚                          â”‚â”‚
â”‚  â”‚ - is_system          â”‚          â”‚ Indexes:                 â”‚â”‚
â”‚  â”‚                      â”‚          â”‚ - goal_template_id (FK)  â”‚â”‚
â”‚  â”‚ CASCADE DELETE â†’     â”‚          â”‚ - display_order          â”‚â”‚
â”‚  â”‚ Removes all tasks    â”‚          â”‚                          â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  task_templates (EXISTING - Extended)                   â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ [Original columns...]                                   â”‚  â”‚
â”‚  â”‚ + goal_template_id (UUID, nullable) [NO FK]           â”‚  â”‚
â”‚  â”‚ + applied_from_template_name (TEXT)                   â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚ Why no FK? Tasks are independent after creation.       â”‚  â”‚
â”‚  â”‚ Template can be deleted without affecting tasks.       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  daily_task_logs (EXISTING)                             â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚  â”‚
â”‚  â”‚  Stores completion logs for task_templates             â”‚  â”‚
â”‚  â”‚  (Applied template tasks can be logged normally)       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow: Apply Template

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER APPLIES TEMPLATE                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Click "Apply" Button   â”‚
                    â”‚  (from preview modal)   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â†“
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  applyGoalTemplate(uuid)     â”‚
                  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
                  â”‚  Server Action (async)       â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â†“               â†“               â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Auth Check  â”‚ â”‚ Fetch Goal  â”‚ â”‚ Fetch Goal   â”‚
        â”‚ User ID =?  â”‚ â”‚ Template    â”‚ â”‚ Template     â”‚
        â”‚ Valid?      â”‚ â”‚ from DB     â”‚ â”‚ Tasks        â”‚
        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                â”‚               â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  For Each Task:         â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
                    â”‚  â”‚ Create new       â”‚   â”‚
                    â”‚  â”‚ task_template:   â”‚   â”‚
                    â”‚  â”‚ - user_id        â”‚   â”‚
                    â”‚  â”‚ - title          â”‚   â”‚
                    â”‚  â”‚ - category       â”‚   â”‚
                    â”‚  â”‚ - task_type:     â”‚   â”‚
                    â”‚  â”‚   "recurring"    â”‚   â”‚
                    â”‚  â”‚ - is_active:true â”‚   â”‚
                    â”‚  â”‚ - goal_template_ â”‚   â”‚
                    â”‚  â”‚   id (ref only)  â”‚   â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Bulk Insert All Tasks  â”‚
                    â”‚  to task_templates      â”‚
                    â”‚  (single query)         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â†“                             â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ SUCCESS         â”‚         â”‚ ERROR           â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ Return:         â”‚         â”‚ Throw error     â”‚
        â”‚ {               â”‚         â”‚ msg to client   â”‚
        â”‚   success: true â”‚         â”‚                 â”‚
        â”‚   templates     â”‚         â”‚ Toast shows:    â”‚
        â”‚   Created: 5    â”‚         â”‚ "Failed..."     â”‚
        â”‚   templateName  â”‚         â”‚                 â”‚
        â”‚ }               â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
                 â”‚                           â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Show Toast Notificationâ”‚
                    â”‚  Success or Error       â”‚
                    â”‚  Auto-hide after 4s    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Close Preview Modal    â”‚
                    â”‚  (on success only)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Back to GoalTemplates  â”‚
                    â”‚  List View              â”‚
                    â”‚                         â”‚
                    â”‚  RESULT: 5 new active   â”‚
                    â”‚  recurring tasks in     â”‚
                    â”‚  user's checklist       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Hierarchy

```
GoalTemplatesPage (Server)
â”‚
â”œâ”€ [server] getInitialTemplates()
â”‚  â””â”€ Supabase query
â”‚
â””â”€ <GoalTemplatesListView>  (Client)
   â”‚
   â”œâ”€ useState: selectedFocus
   â”œâ”€ useState: previewTemplate
   â”œâ”€ useState: isApplying
   â”œâ”€ useState: notification
   â”‚
   â”œâ”€ handlePreview()
   â”‚  â””â”€ getGoalTemplateWithTasks()
   â”‚     â””â”€ Server action
   â”‚
   â”œâ”€ handleApply()
   â”‚  â””â”€ applyGoalTemplate()
   â”‚     â””â”€ Server action
   â”‚
   â”œâ”€ showNotification()
   â”‚
   â””â”€ JSX:
      â”‚
      â”œâ”€ <h1> Header
      â”‚
      â”œâ”€ [Focus filter pills]
      â”‚  â”œâ”€ "All" button
      â”‚  â”œâ”€ "Productivity" button
      â”‚  â”œâ”€ "Training" button
      â”‚  â””â”€ ...more
      â”‚
      â”œâ”€ {filteredTemplates.map()}
      â”‚  â”‚
      â”‚  â””â”€ <GoalTemplateCard>
      â”‚     â”‚
      â”‚     â”œâ”€ template: GoalTemplate
      â”‚     â”œâ”€ taskCount: number
      â”‚     â”œâ”€ onPreview: () => void
      â”‚     â”œâ”€ onApply: () => void
      â”‚     â”œâ”€ isApplying: boolean
      â”‚     â”‚
      â”‚     â””â”€ JSX:
      â”‚        â”œâ”€ <div> Card container
      â”‚        â”œâ”€ <h3> Template name
      â”‚        â”œâ”€ <p> Description
      â”‚        â”œâ”€ [Focus badge]
      â”‚        â”œâ”€ Task count
      â”‚        â””â”€ [Preview] [Apply] buttons
      â”‚
      â”œâ”€ {previewTemplate && (
      â”‚  â”‚
      â”‚  â””â”€ <GoalTemplatePreview>
      â”‚     â”‚
      â”‚     â”œâ”€ template: GoalTemplateWithTasks
      â”‚     â”œâ”€ onClose: () => void
      â”‚     â”œâ”€ onApply: () => void
      â”‚     â”œâ”€ isApplying: boolean
      â”‚     â”‚
      â”‚     â””â”€ JSX:
      â”‚        â”œâ”€ [Modal overlay]
      â”‚        â”œâ”€ [Header]
      â”‚        â”‚  â”œâ”€ Template name
      â”‚        â”‚  â”œâ”€ Focus badge
      â”‚        â”‚  â”œâ”€ Description
      â”‚        â”‚  â””â”€ [Close Ã—]
      â”‚        â”œâ”€ [Content]
      â”‚        â”‚  â”œâ”€ Task count box
      â”‚        â”‚  â”œâ”€ Duration box
      â”‚        â”‚  â””â”€ Task list
      â”‚        â”‚     â””â”€ map(tasks)
      â”‚        â”‚        â”œâ”€ Task number
      â”‚        â”‚        â”œâ”€ Title + Optional badge
      â”‚        â”‚        â”œâ”€ Description
      â”‚        â”‚        â””â”€ Category + Duration
      â”‚        â”œâ”€ [Info callout]
      â”‚        â””â”€ [Footer]
      â”‚           â””â”€ [Cancel] [Apply Template]
      â”‚
      â””â”€ {notification && (
         â”‚
         â””â”€ Toast div
            â”œâ”€ Type: success (green) or error (red)
            â””â”€ Message text
```

## Database Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Database Relationships                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    goal_templates           â”‚
â”‚  (Template Collections)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)                     â”‚
â”‚ name                        â”‚
â”‚ description                 â”‚
â”‚ focus_area                  â”‚
â”‚ is_system                   â”‚
â”‚ created_by                  â”‚
â”‚ created_at                  â”‚
â”‚ updated_at                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ 1
               â”‚
               â”‚ (One template has many tasks)
               â”‚
               â”‚ ON DELETE CASCADE
               â”‚ (Delete template â†’ delete tasks)
               â”‚
               â”‚ Many
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  goal_template_tasks        â”‚
â”‚  (Individual Tasks)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)                     â”‚
â”‚ goal_template_id (FK) â—„â”€â”€â”€â”€â”€â”¤â”€ Foreign Key
â”‚ title                       â”‚
â”‚ description                 â”‚
â”‚ category                    â”‚
â”‚ is_optional                 â”‚
â”‚ estimated_duration_minutes  â”‚
â”‚ display_order               â”‚
â”‚ created_at                  â”‚
â”‚ updated_at                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


When Template is Applied:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

goal_template_tasks â”€â”€[COPY DATA]â”€â”€> task_templates
(Blueprint)                          (Live User Tasks)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ goal_template_task      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id: uuid1               â”‚
â”‚ title: "Deep Work"      â”‚
â”‚ category: "Productivity"â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ User applies
             â”‚ template
             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ new task_template              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id: uuid2                      â”‚
â”‚ user_id: <current_user>        â”‚
â”‚ title: "Deep Work"             â”‚
â”‚ category: "Productivity"       â”‚
â”‚ task_type: "recurring"         â”‚
â”‚ is_active: true                â”‚
â”‚ goal_template_id: <ref-only>   â”‚ â—„â”€ NO FK!
â”‚ applied_from_template_name:    â”‚
â”‚   "Deep Work Session"          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

NOTE: goal_template_id in task_templates is
      for reference/UX only - NOT a foreign key
      
      This allows:
      - task_templates to be edited independently
      - goal_templates to be deleted safely
      - Clear mental model: "Copy, not link"
```

## User Journey Map

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       User Journey Map                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

START: User wants to build momentum on their tasks
   â”‚
   â†“
User visits /templates
   â”‚
   â”œâ”€ [Server] Loads 5 default templates
   â”‚
   â†“
Sees "Goal Templates" page with:
   â”‚
   â”œâ”€ "Deep Work Session" card
   â”œâ”€ "Skill Building" card
   â”œâ”€ "Creative Flow" card
   â”œâ”€ "Daily Wellness" card
   â””â”€ "Mindful Morning" card
   â”‚
   â”œâ”€ Optional: Filter by focus area
   â”‚  â””â”€ [All] [Productivity] [Training] [Creative] ...
   â”‚
   â†“
User clicks "Preview" on a template
   â”‚
   â”œâ”€ Modal opens showing:
   â”‚  â”œâ”€ All tasks (e.g., 5 tasks for Deep Work)
   â”‚  â”œâ”€ Descriptions
   â”‚  â”œâ”€ Optional task indicators
   â”‚  â”œâ”€ Duration estimates
   â”‚  â””â”€ "ğŸ’¡ Tasks are editable after applying"
   â”‚
   â†“
User reads and understands
   â”‚
   â†“
User clicks "Apply Template"
   â”‚
   â”œâ”€ [Server] Creates 5 new recurring task_templates
   â”œâ”€ [Server] Sets is_active: true for all
   â”œâ”€ Toast notification: "âœ“ Applied Deep Work with 5 tasks!"
   â”‚
   â†“
Modal closes, returns to list
   â”‚
   â†“
User visits /today (daily checklist)
   â”‚
   â””â”€ Sees 5 NEW active tasks:
      â”œâ”€ [ ] Prepare workspace (5m)
      â”œâ”€ [ ] Set timer for focus block (1m)
      â”œâ”€ [ ] Deep work sprint (25m)
      â”œâ”€ [ ] Quick break (5m)
      â””â”€ [ ] Reflect on progress (optional, 3m)
   â”‚
   â†“
User can now:
   â”‚
   â”œâ”€ Check off tasks as they complete them
   â”œâ”€ Edit task titles/categories
   â”œâ”€ Toggle tasks active/inactive
   â”œâ”€ Delete tasks they don't want
   â”œâ”€ Convert to one-off tasks
   â””â”€ Apply more templates if they want
   â”‚
   â†“
RESULT: User has momentum with achievable daily tasks!

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

OPTIONAL: Advanced user creates custom template
   â”‚
   â”œâ”€ (Future feature)
   â”œâ”€ Can save favorite task combinations
   â”œâ”€ Can share with team
   â””â”€ Can rate/review templates
```

---

This architecture ensures:
âœ… Clear separation of concerns
âœ… Scalable database design
âœ… Independent task management
âœ… Simple, intuitive user flow
âœ… No external dependencies
âœ… Performance optimized
